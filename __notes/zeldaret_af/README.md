# REPOSITORY

project:  
https://zeldaret.github.io/af/  
https://github.com/zeldaret/af  




# Quick Setup

### definitely read the original docs
- `README.md`
	- open `Turn Windows features on or off`, enable `Windows Subsystem for Linux`
	- run `wsl --install`, follow the instructions
	- run `wsl` in the project directory or open it in a Linux terminal
	- follow the instructions

### alternatively, put in the root folder
- `project.code-workspace`
- `project.sublime-project`
- `compile_flags.txt`




# Additional Info

## Links
https://www.copetti.org/writings/consoles/nintendo-64  
https://en.wikibooks.org/wiki/N64_Programming  
https://en.wikipedia.org/wiki/64DD  
https://n64brew.dev/wiki/Main_Page  

## Tools

- [m2c](https://github.com/matt-kempster/m2c) to get initial C code
  ```
  # given it's imported cloned `../m2c/`
  .venv/bin/python3 ../m2c/m2c.py %path_to.s% --context ctx.c --unk-underscore
  ```
- [m2ctx](https://github.com/zeldaret/af/blob/main/tools/m2ctx.py) to create decompilation context `--context ctx.c`
  ```
  .venv/bin/python3 tools/m2ctx.py %path_to.c%
  ```
- [diff](https://github.com/zeldaret/af/blob/main/tools/asm-differ/diff.py) to interactively recompile and compare
  ```
  .venv/bin/python3 tools/asm-differ/diff.py -mwo3 %function%
  ```
- [permuter](https://github.com/simonlindholm/decomp-permuter) to generate ideas
  ```
  # given it's imported cloned `../decomp-permuter/`
  .venv/bin/python3 ../decomp-permuter/import.py %path_to.c% %path_to.s%

  # this create `nonmatchings/*`
  .venv/bin/python3 ../decomp-permuter/permute.py nonmatchings/%function%
  ```

## Docs
- [OoT](https://github.com/zeldaret/oot/blob/9963e7f5d5fa8caee329f6b40e393d8a2c45390b/docs/tutorial/beginning_decomp.md) decompilation tutorial
- [MM](https://github.com/zeldaret/mm/blob/main/docs/tutorial/beginning_decomp.md) decompilation tutorial
- [permuter](https://github.com/zeldaret/oot/blob/9963e7f5d5fa8caee329f6b40e393d8a2c45390b/docs/tutorial/other_functions.md#the-permuter) usage

## Notes
- btw, read about draw functions too, they are a bit special
- remember that even slight changes can throw codegen drastically




# Temporary

studying radio
```
aRAD_shadow_vertices = 0x06005B18;
aRAD_shadow_model = 0x06005B98;
aRAD_model = 0x06054678;




vram_start,given_name,name,type,given_size,size,rom,defined,user_declared,referenced,extract

6054678,None,D_6054678,None,None,4,None,False,False,True,True




category,address,name,getName,getNameEnd,userDeclaredType,autodetectedType,getType,accessType,userDeclaredSize,autodetectedSize,getSize,getVrom,sectionType,isDefined,isUserDeclared,isAutogenerated,isMaybeString,failedStringDecoding,isMaybePascalString,failedPascalStringDecoding,referenceCounter,parentFunction,parentFileName,inFileOffset,overlayCategory,unknownSegment,isGot,isGotGlobal,isGotLocal,gotIndex,accessedAsGpRel,firstLoAccess,isAutogeneratedPad,autoCreatedPadMainSymbol,isElfNotype,isAutocreatedSymFromOtherSizedSym,isMips1Double,visibility

symbol,0x06054678,None,D_6054678,None,None,None,,None,None,None,0x4,0x0,,False,False,True,False,False,False,False,1,None,None,None,None,True,False,False,False,None,False,224,False,,False,False,False,None




- name: ovl_Radio
  type: code
  start: 0x936BC0
  vram: 0x80A76920
  follows_vram: ovl_Goza_reloc
  compress: True
  bss_size: 0x0
  subsegments:
    - [0x936BC0, c, overlays/actors/ovl_Radio/ac_radio]
    - [0x937070, .data, overlays/actors/ovl_Radio/ac_radio]
- name: ovl_Radio_reloc
  type: code
  start: 0x9370C0
  vram: 0x80A76E20
  follows_vram: ovl_Radio
  compress: True
  subsegments:
    - [0x9370C0, data, overlays/actors/ovl_Radio/ac_radio_reloc]
```

compare with the football
```
- name: ovl_Ball
  type: code
  start: 0x85D660
  vram: 0x80968A10
  follows_vram: ovl_Airplane_reloc
  compress: True
  bss_size: 0x10
  subsegments:
    - [0x85D660, c, overlays/actors/ovl_Ball/ac_ball]
    - [0x85F500, .data, overlays/actors/ovl_Ball/ac_ball]
    - [0x85F550, .rodata, overlays/actors/ovl_Ball/ac_ball]
    - { start: 0x85F5D0, type: .bss, vram: 0x8096A980, name: overlays/actors/ovl_Ball/ac_ball }
- name: ovl_Ball_reloc
  type: code
  start: 0x85F5D0
  vram: 0x8096A990
  follows_vram: ovl_Ball
  compress: True
  subsegments:
    - [0x85F5D0, data, overlays/actors/ovl_Ball/ac_ball_reloc]




- name: act_ball_s
  dir: objects/act_ball_s
  type: code
  start: 0x1102000
  vram: 0x06000000
  exclusive_ram_id: segment_06
  compress: True
  align: 0x1000
  symbol_name_format: $VRAM_$ROM
  subsegments:
    - [auto, c, act_ball_s]
    - start: 0x1102000
      type: .data
      name: act_ball_s
      subsegments:
        - [0x1102000, vtx, act_ball_s_v]
        - [0x1102700, af_gfx, act_ball_s_modelT]
        - [0x1102708, af_gfx, act_ball_s_model]
        - [0x11028B8, af_palette, act_ball_s_pal]
        - [0x11028D8, ci4, act_ball_s_5_tex, 16, 32, act_ball_s_pal]
- [0x11029E0]




category,address,name,getName,getNameEnd,userDeclaredType,autodetectedType,getType,accessType,userDeclaredSize,autodetectedSize,getSize,getVrom,sectionType,isDefined,isUserDeclared,isAutogenerated,isMaybeString,failedStringDecoding,isMaybePascalString,failedPascalStringDecoding,referenceCounter,parentFunction,parentFileName,inFileOffset,overlayCategory,unknownSegment,isGot,isGotGlobal,isGotLocal,gotIndex,accessedAsGpRel,firstLoAccess,isAutogeneratedPad,autoCreatedPadMainSymbol,isElfNotype,isAutocreatedSymFromOtherSizedSym,isMips1Double,visibility

category,address,name,getName,getNameEnd,userDeclaredType,autodetectedType,getType,accessType,userDeclaredSize,autodetectedSize,getSize,getVrom,sectionType,isDefined,isUserDeclared,isAutogenerated,isMaybeString,failedStringDecoding,isMaybePascalString,failedPascalStringDecoding,referenceCounter,parentFunction,parentFileName,inFileOffset,overlayCategory,unknownSegment,isGot,isGotGlobal,isGotLocal,gotIndex,accessedAsGpRel,firstLoAccess,isAutogeneratedPad,autoCreatedPadMainSymbol,isElfNotype,isAutocreatedSymFromOtherSizedSym,isMips1Double,visibility
symbol,0x06000000,None,act_ball_s_v,None,None,None,,None,0x700,None,0x700,0x1102000,.data,True,True,False,False,False,False,False,0,None,act_ball_s,0,segment_06,False,False,False,False,None,False,None,False,,False,False,False,None
symbol,0x06000700,None,act_ball_s_modelT,None,None,None,,None,None,None,0x4,0x1102700,.data,True,True,False,False,False,False,False,0,None,act_ball_s,1792,segment_06,False,False,False,False,None,False,None,False,,False,False,False,None
symbol,0x06000708,None,act_ball_s_model,None,None,None,,None,None,None,0x4,0x1102708,.data,True,True,False,False,False,False,False,0,None,act_ball_s,1800,segment_06,False,False,False,False,None,False,None,False,,False,False,False,None
symbol,0x060008B8,None,act_ball_s_pal,None,None,None,,None,None,None,0x4,0x11028B8,.data,True,True,False,False,False,False,False,0,None,act_ball_s,2232,segment_06,False,False,False,False,None,False,None,False,,False,False,False,None
symbol,0x060008D8,None,act_ball_s_5_tex,None,None,None,,None,None,None,0x4,0x11028D8,.data,True,True,False,False,False,False,False,0,None,act_ball_s,2264,segment_06,False,False,False,False,None,False,None,False,,False,False,False,None




category,address,name,getName,getNameEnd,userDeclaredType,autodetectedType,getType,accessType,userDeclaredSize,autodetectedSize,getSize,getVrom,sectionType,isDefined,isUserDeclared,isAutogenerated,isMaybeString,failedStringDecoding,isMaybePascalString,failedPascalStringDecoding,referenceCounter,parentFunction,parentFileName,inFileOffset,overlayCategory,unknownSegment,isGot,isGotGlobal,isGotLocal,gotIndex,accessedAsGpRel,firstLoAccess,isAutogeneratedPad,autoCreatedPadMainSymbol,isElfNotype,isAutocreatedSymFromOtherSizedSym,isMips1Double,visibility

symbol,0x06000708,None,act_ball_s_model,None,None,None,,None,None,None,0x4,0x0,,False,False,True,False,False,False,False,1,None,None,None,None,True,False,False,False,None,False,128,False,,False,False,False,None




act_ball_s_v = 0x6000000; // segment:act_ball_s rom:0x1102000 size:0x700
act_ball_s_modelT = 0x6000700; // segment:act_ball_s rom:0x1102700
act_ball_s_model = 0x6000708; // segment:act_ball_s rom:0x1102708
act_ball_s_pal = 0x60008B8; // segment:act_ball_s rom:0x11028B8
act_ball_s_5_tex = 0x60008D8; // segment:act_ball_s rom:0x11028D8
```
